/*
 * compTable - a jQuery plugin to dynamically compare information in tables
 * @copyright Nikolas Grottendieck, Jan Musmann 2013
 * @license https://github.com/Okeanos/compTable/blob/master/LICENSE
 */
(function($){var i,settings;$.fn.compTable=function(options){var defaults={structure:"",content:"",columns:3,defaultValues:[],header:"first",footer:"last",tableAttr:{}};settings=$.extend({},defaults,options);if(typeof settings.header==="number"){settings.header=Math.round(Math.abs(settings.header))}if(typeof settings.footer==="number"){settings.footer=Math.round(Math.abs(settings.footer))}this.append(renderCompTables())};function renderCompTables(){var tempWrapper=$(),hasColLabels=[];for(i=0;i<settings.structure.length;i++){hasColLabels[i]=[false,false]}$(["header","footer"]).each(function(index,value){if(typeof settings[value]==="string"){if(settings[value]==="first"){hasColLabels[0][index]=true}else if(settings[value]==="last"){hasColLabels[settings.structure.length-1][index]=true}}else if(typeof settings[value]==="number"&&settings[value]!==0){for(i=settings.structure.length-1;i>=0;i--){if(i%settings[value]===0){hasColLabels[i][index]=true}}}});$(settings.structure).each(function(tIndex,tValue){var table=$("<table><caption></caption><tbody></tbody></table>"),tbody=$("tbody",table);table.attr("id",tValue.id);assignAttributes(settings.tableAttr,table);assignAttributes(tValue.attr,table);$("caption",table).html(tValue.title);if(hasColLabels[tIndex][0]){table.children("caption").after(createColLabels("<thead>"))}if(hasColLabels[tIndex][1]){table.children("tbody").after(createColLabels("<tfoot>"))}$(this.rows).each(function(rIndex,rValue){var tr=$("<tr>"),th=$("<th>").html(rValue.name);assignAttributes(rValue.trAttr,tr);assignAttributes(rValue.thAttr,th);tr.append(th);for(i=0;i<settings.columns;i++){tr.append($("<td>"))}tbody.append(tr)});tempWrapper=tempWrapper.add(table)});return tempWrapper}$.fn.compTable.clearColumn=function(colIndex){$(settings.structure).each(function(tIndex,tValue){$("#"+tValue.id+" > thead > tr, "+"#"+tValue.id+" > tfoot > tr").find("th:eq("+colIndex+")").html("");$("#"+tValue.id+" > tbody > tr").each(function(){$(this).find("td:eq("+colIndex+")").html("")})})};$.fn.compTable.insertColumnData=function(colIndex,dataId,clearOnEmpty){clearOnEmpty=typeof clearOnEmpty!=="undefined"?clearOnEmpty:false;if(typeof settings.content[dataId]!=="undefined"){$(settings.structure).each(function(tIndex,tValue){$("#"+tValue.id+" > thead > tr, "+"#"+tValue.id+" > tfoot > tr").find("th:eq("+colIndex+")").html(dataId);$("#"+tValue.id+" > tbody > tr").each(function(dIndex){$(this).find("td:eq("+colIndex+")").html(settings.content[dataId][tIndex][dIndex])})})}else if(clearOnEmpty){$().compTable.clearColumn(colIndex)}};function assignAttributes(source,target){if(typeof source!=="undefined"){for(var attrIndex in source){target.attr(attrIndex,source[attrIndex])}}}function createColLabels(pos){var tPos=$(pos),tr=$("<tr>");tr.append($("<td>"));for(i=0;i<settings.columns;i++){tr.append($("<th>"))}return tPos.append(tr)}})(jQuery,document,window);